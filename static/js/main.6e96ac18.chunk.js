(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],[,,,,,,,,,,,,function(t,e,a){"use strict";var s=a(2),n=a(3),r=a(5),i=a(4),o=a(1),l=a(6),c=a(0),u=a.n(c),d=function(t){function e(t){var a;return Object(s.a)(this,e),(a=Object(r.a)(this,Object(i.a)(e).call(this,t))).state={data:t.data},a}return Object(l.a)(e,t),Object(n.a)(e,[{key:"componentWillMount",value:function(){var t=new Uint8Array(this.state.data),e=new DataView(t.buffer),a=document.createElement("canvas"),s=a.getContext("2d");a.width=e.getUint32(0,!1),a.height=e.getUint32(4,!1);for(var n=s.createImageData(a.width,a.height),r=a.width*a.height,i=0;i<r;i++){var o=8+4*i,l=e.getUint32(o,!1)/255,c=4*i;n.data[c]=l,n.data[c+1]=l,n.data[c+2]=l,n.data[c+3]=255}s.putImageData(n,0,0);var u=a.toDataURL();this.setState({dataURI:u})}},{key:"render",value:function(){return u.a.createElement("img",{src:this.state.dataURI,alt:""})}}]),e}(c.Component),h=a(17),f=a.n(h),m={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",maxWidth:"50%",maxHeight:"50%",margin:"auto",borderRadius:"20px",backgroundColor:"rgba(0,0,0, 0.6)",zIndex:"10"},p={position:"absolute",left:"5%",right:"5%",color:"#3d3d3d",top:"10%",bottom:"5%",margin:"auto",borderRadius:"20px",background:"white",text:"left",overflow:"auto"},w={marginTop:"5%",marginBottom:"5%"},b={zIndex:"50,"},v=function(t){function e(){return Object(s.a)(this,e),Object(r.a)(this,Object(i.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(n.a)(e,[{key:"render",value:function(){return u.a.createElement(f.a,{axis:"both",handle:".handle",defaultPosition:{x:0,y:0},position:null,grid:[25,25],scale:1,onStart:this.handleStart,onDrag:this.handleDrag,onStop:this.handleStop},u.a.createElement("div",{style:m,className:"handle"},u.a.createElement("div",{className:"d-flex justify-content-end m-0"},u.a.createElement("button",{style:b,className:"btn btn-md btn-secondary bottom m-1",onClick:this.props.closePopup},u.a.createElement("span",{role:"img","aria-label":"close"},"\u274c"))),u.a.createElement("div",{style:p,className:"popup\\_inner"},u.a.createElement("div",{style:w},u.a.createElement("pre",{className:"text-left row m-2 container-fluid"},this.props.data)))))}}]),e}(u.a.Component),g=function(t){function e(t){var a;return Object(s.a)(this,e),(a=Object(r.a)(this,Object(i.a)(e).call(this,t))).state={application:t.application,data:t.data,doi:"",viewerIsShown:t.viewerIsShown,showData:t.showData,cache:t.cache},a.state.application&&(a.updateDataView=a.updateDataView.bind(Object(o.a)(a)),a.state.application.setUpdateDataView(a.updateDataView)),a.clearDataView=a.clearDataView.bind(Object(o.a)(a)),a}return Object(l.a)(e,t),Object(n.a)(e,[{key:"clearDataView",value:function(){this.updateDataView(null)}},{key:"updateDataView",value:function(t){this.setState({data:t})}},{key:"render",value:function(){if(null==this.state.data)return u.a.createElement("div",{className:"DataViewer p-2 bg-secondary rounded mb-0 text-white"},this.props.viewerIsShown?u.a.createElement("div",null,u.a.createElement("div",{className:"col-md-12 font-weight-bold m-2"},"DATA VIEW"),u.a.createElement("div",{className:"alert alert-success alert-dismissible fade show text-truncate text-left m-2"},"Fetch manifest and/or data")," "):null);var t="";this.state.application&&(t=u.a.createElement("div",null,u.a.createElement("button",{className:"btn btn-sm btn-warning m-3",onClick:this.clearDataView},"Clear")));var e="Not supported to view MIME ("+this.state.data.MIME+")";-1!==this.state.data.MIME.indexOf("text")&&(e=0!==this.state.data.data.length?(new TextDecoder).decode(new Uint8Array(this.state.data.data)):"{empty}");return-1!==this.state.data.MIME.indexOf("json")&&(e=JSON.stringify(this.state.data.data,void 0,2)),-1!==this.state.data.MIME.indexOf("manifest")&&(e=JSON.stringify(this.state.data.data.json,void 0,2)),-1!==this.state.data.MIME.indexOf("octet-stream")&&(e=this.stringFromOctetStream(this.state.data.data)),-1!==this.state.data.MIME.indexOf("BufImage/Grey32")&&(e=u.a.createElement(d,{data:this.state.data.data})),this.props.viewerIsShown?u.a.createElement("div",{className:"DataViewer bg-secondary rounded mb-0 text-white p-2"},u.a.createElement("div",{className:"col-md-12 font-weight-bold m-2"},"DATA VIEW"),u.a.createElement("div",{className:"alert alert-success alert-dismissible fade show text-truncate m-2"},u.a.createElement("pre",{className:"text-left row m-2 container-fluid"},e)),u.a.createElement("div",null,this.state.doi),u.a.createElement("div",{className:"col-md-12"},t)):this.props.showData?u.a.createElement(v,{data:e,closePopup:this.props.dataTogglePopup}):null}},{key:"stringFromOctetStream",value:function(t){var e="",a=t.length;a>50&&(a=50,e="First 50 bytes: ");for(var s=0;s<a;){var n=t[s++].toString(16).toUpperCase();1===n.length&&(n="0"+n),e+=n}return e}}]),e}(c.Component);e.a=g},function(t,e,a){"use strict";(function(t){var s=a(2),n=a(3);a(27),a(28),a(29),a(30),a(31),a(32),a(33),a(37);var r=function(){function e(a,n){Object(s.a)(this,e);var r={Network:{DedicatedServer:a},Cache:{Use_localStorage:n}};this.engine=new t.Engine(r),this.update_manifest=null,this.update_data_view=null,this.current_manifest=null,this.current_manifest_status="Not defined",this.manifest_focus_list=[]}return Object(n.a)(e,[{key:"setUpdateManifest",value:function(t){this.update_manifest=t}},{key:"setUpdateDataView",value:function(t){this.update_data_view=t}},{key:"updateDataView",value:function(t){null!=this.update_data_view&&this.update_data_view(t)}},{key:"getCache",value:function(){return this.engine.cache()}},{key:"getNetwork",value:function(){return this.engine.network()}},{key:"getCurrentManifest",value:function(){var t={status:"ok",data:null};return t.data=this.current_manifest,t.status=this.current_manifest_status,t}},{key:"setNewManifest",value:function(e){if(null==e)return this.current_manifest=null,this.current_manifest_status="Not defined",void this.update_manifest();this.manifest_focus_list=[],this.current_manifest=null,this.current_manifest_status="Not defined";try{this.current_manifest=new t.Manifest(JSON.parse(e)),this.current_manifest_status="ok"}catch(a){this.current_manifest_status="Error creating manifest: "+a}null!==this.update_manifest&&this.update_manifest()}},{key:"PushManifestFocusList",value:function(t){0===this.manifest_focus_list.length&&this.manifest_focus_list.push({data:this.current_manifest,status:this.current_manifest_status}),this.manifest_focus_list.push({data:t.data,status:t.status}),this.current_manifest=t.data,this.current_manifest_status=t.status,null!==this.update_manifest&&this.update_manifest()}},{key:"PopManifestFocusList",value:function(){var t=this.manifest_focus_list.pop();null!=t&&null!=(t=this.manifest_focus_list.pop())&&(this.current_manifest=t.data,this.current_manifest_status=t.status,null!==this.update_manifest&&this.update_manifest())}},{key:"ManifestFocusListIsEmpty",value:function(){return 0===this.manifest_focus_list.length}}]),e}();e.a=r}).call(this,a(7))},,,,,function(t,e,a){"use strict";(function(t,s){var n=a(2),r=a(3),i=a(5),o=a(4),l=a(1),c=a(6),u=a(0),d=a.n(u),h=a(8),f=a.n(h),m=a(13),p=a(12),w=function(e){function a(t){var e;return Object(n.a)(this,a),(e=Object(i.a)(this,Object(o.a)(a).call(this,t))).state={textAreaID:t.textAreaID,manifestDataHolderID:t.manifestDataHolderID,viewerIsShown:!1,showData:!1},e.actionClick=e.actionClick.bind(Object(l.a)(e)),e}return Object(c.a)(a,e),Object(r.a)(a,[{key:"actionClick",value:function(e){var a=this;f.a.unmountComponentAtNode(document.getElementById(this.state.manifestDataHolderID));var n=e.target.innerHTML;e.target.innerHTML="evaluating...",this.setState({viewerIsShown:!this.state.viewerIsShown});var r=new m.a("https://kolmoblocks.org/StaticData",!1),i={MIME:"",data:""},o=null;try{var l=document.getElementById(this.state.textAreaID).value;o=new t.Manifest(JSON.parse(l))}catch(c){i.MIME="text",i.data=new Uint8Array(s.from(""+c))}if(null==o)return f.a.render(d.a.createElement(p.a,{viewerIsShown:this.state.viewerIsShown,showData:this.state.showData,data:i}),document.getElementById(this.state.manifestDataHolderID)),void(e.target.innerHTML=n);o.target=e.target,o.btn_caption=n,r.engine.eval_manifest(o).then((function(t){o.target.innerHTML=o.btn_caption,t.data.MIME?i.MIME=t.data.MIME:i.MIME="text",i.data=t.data,f.a.render(d.a.createElement(p.a,{viewerIsShown:a.state.viewerIsShown,showData:a.state.showData,data:i}),document.getElementById(a.state.manifestDataHolderID))}))}},{key:"render",value:function(){return d.a.createElement("button",{className:"btn btn-sm btn-warning m-2 float-center",onClick:this.actionClick},"View Data")}}]),a}(u.Component);e.a=w}).call(this,a(7),a(38).Buffer)},function(t,e,a){t.exports=a(42)},,,,,function(t,e,a){},function(t,e,a){},,function(t,e,a){(function(t){var e=a(11),s=a(9),n=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Engine=function(){"use strict";function a(e){if(s(this,a),e.hasOwnProperty("Cache")?this.Cache=new t.Cache(e.Cache):this.Cache=new t.Cache,!e.hasOwnProperty("Network"))throw new Error("Bad engine settings");this.Network=new t.Network(e.Network,this.Cache)}return n(a,[{key:"network",value:function(){return this.Network}},{key:"cache",value:function(){return this.Cache}},{key:"eval_manifest",value:function(t){var a,s,n,r,i,o,l,c,u;return e.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(a={status:"",data:[]},"ok"!==(s=t.get_raw_value()).status){d.next=6;break}return a.status="ok",a.data=s.data,d.abrupt("return",a);case 6:return d.next=8,e.awrap(this.Network.search_data(t));case 8:if("ok"!==(n=d.sent).status){d.next=13;break}return a.status="ok",a.data=n.data,d.abrupt("return",a);case 13:if(0!==t.get_formulas().data.length){d.next=25;break}return a.status="Manifest has no formulas",d.next=18,e.awrap(this.Network.search_manifest(t));case 18:if("ok"===(t=d.sent).status){d.next=24;break}return a.status=t.status,d.abrupt("return",a);case 24:t=t.data;case 25:return d.next=27,e.awrap(this.get_formulas_datainfo(t));case 27:if("ok"!==(r=d.sent).status){d.next=41;break}for(l in i=null,o=0,r.data)c=r.data[l].NeedBytes-r.data[l].HasBytes,i||(o=c,i=r.data[l].Formula),o>c&&(o=c,i=r.data[l].Formula);if(!i){d.next=41;break}return d.next=35,e.awrap(this.eval_formula(i));case 35:if("ok"!==(u=d.sent).status){d.next=40;break}return a.status="ok",a.data=u.data,d.abrupt("return",a);case 40:a.status=u.status;case 41:return d.abrupt("return",a);case 42:case"end":return d.stop()}}),null,this)}},{key:"eval_formula",value:function(t){var a,s,n,r;return e.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a={status:"",data:[]},"ok"!==(s=t.get_dependencies()).status){i.next=20;break}i.t0=e.keys(s.data);case 4:if((i.t1=i.t0()).done){i.next=18;break}return n=i.t1.value,i.next=8,e.awrap(this.Network.search_data(s.data[n]));case 8:if("ok"===i.sent.status){i.next=16;break}return i.next=12,e.awrap(this.eval_manifest(s.data[n]));case 12:if("ok"===(r=i.sent).status){i.next=16;break}return a.status=r.status,i.abrupt("return",a);case 16:i.next=4;break;case 18:i.next=22;break;case 20:return a.status="Formula has no dependencies",i.abrupt("return",a);case 22:return i.next=24,e.awrap(this.eval(t));case 24:return i.abrupt("return",i.sent);case 25:case"end":return i.stop()}}),null,this)}},{key:"eval",value:function(t){var a,s,n,r,i,o,l,c,u,d,h,f;return e.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(a={status:"",source:null,data:[]},s=null,!t.manifest){m.next=17;break}if("ok"!==(n=t.manifest.get_doi()).status){m.next=17;break}m.t0=e.keys(n.data);case 6:if((m.t1=m.t0()).done){m.next=17;break}if(r=m.t1.value,s=n.data[r],"ok"!==(i=this.Cache.get_data_by_doi(s)).status){m.next=15;break}return a.status="ok",a.source="Cache",a.data=i.data,m.abrupt("return",a);case 15:m.next=6;break;case 17:if(o=new Map,"ok"!==(l=t.get_dependencies()).status){m.next=42;break}m.t2=e.keys(l.data);case 21:if((m.t3=m.t2()).done){m.next=40;break}return c=m.t3.value,u=l.data[c],m.next=26,e.awrap(this.Cache.get_data_by_manifest(u));case 26:if("ok"!==(d=m.sent).status){m.next=31;break}o.set(u.ArgName,d.data),m.next=38;break;case 31:if("ok"!==(h=u.get_raw_value()).status){m.next=36;break}o.set(u.ArgName,h.data),m.next=38;break;case 36:return a.status="Cache has no data for dependency: "+u.ArgName,m.abrupt("return",a);case 38:m.next=21;break;case 40:m.next=44;break;case 42:return a.status="Formula has no dependencies",m.abrupt("return",a);case 44:return m.next=46,e.awrap(t.eval(o));case 46:return"ok"===(f=m.sent).status?(a.status="ok",a.source="Evaluation",a.data=f.data,s&&this.Cache.set_data_by_doi(f.data,s)):a.status="Error evaluation formula ("+f.status+")",m.abrupt("return",a);case 49:case"end":return m.stop()}}),null,this)}},{key:"get_manifest_datainfo",value:function(t){var a,s,n,r,i,o,l,c,u,d,h;return e.async((function(f){for(;;)switch(f.prev=f.next){case 0:return a={status:"Manifest has no data info",data:null},f.next=3,e.awrap(this.Network.search_manifest(t));case 3:if("ok"===(s=f.sent).status&&(t=s.data),"ok"!==(n=t.get_raw_value()).status){f.next=10;break}return a.status="ok",a.data={Source:"RawValue",NeedBytes:n.data.length,HasBytes:n.data.length},f.abrupt("return",a);case 10:if("ok"!==(r=t.get_doi()).status){f.next=24;break}f.t0=e.keys(r.data);case 13:if((f.t1=f.t0()).done){f.next=24;break}return i=f.t1.value,f.next=17,e.awrap(this.Cache.get_data_by_doi(r.data[i]));case 17:if("ok"!==(o=f.sent).status){f.next=22;break}return a.status="ok",a.data={Source:"Cache",NeedBytes:o.data.length,HasBytes:o.data.length},f.abrupt("return",a);case 22:f.next=13;break;case 24:if(0!==t.get_formulas().data.length){f.next=33;break}if("ok"!==(l=t.get_size()).status){f.next=31;break}return a.status="ok",a.data={Source:"Manifest",NeedBytes:l.data,HasBytes:0},f.abrupt("return",a);case 31:f.next=41;break;case 33:return f.next=35,e.awrap(this.get_formulas_datainfo(t));case 35:if("ok"!==(c=f.sent).status){f.next=41;break}for(u in a.data={Source:"",NeedBytes:0,HasBytes:0},c.data)0==a.data.NeedBytes&&0==a.data.HasBytes&&(a.data.Source=c.data[u].Source,a.data.NeedBytes=c.data[u].NeedBytes,a.data.HasBytes=c.data[u].HasBytes),d=a.data.NeedBytes-a.data.HasBytes,h=c.data[u].NeedBytes-c.data[u].HasBytes,d>h&&(a.data.Source=c.data[u].Source,a.data.NeedBytes=c.data[u].NeedBytes,a.data.HasBytes=c.data[u].HasBytes);return 0!=a.data.NeedBytes&&(a.status="ok"),f.abrupt("return",a);case 41:return f.abrupt("return",a);case 42:case"end":return f.stop()}}),null,this)}},{key:"get_formulas_datainfo",value:function(t){var a,s,n,r,i,o,l,c,u,d,h,f,m;return e.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(a={status:"Formulas has no data info",data:[]},0!==(s=t.get_formulas().data).length){p.next=7;break}return p.next=5,e.awrap(this.Network.search_manifest(t));case 5:"ok"===(n=p.sent).status&&(s=n.data.get_formulas().data);case 7:p.t0=e.keys(s);case 8:if((p.t1=p.t0()).done){p.next=31;break}if(r=p.t1.value,a.status="ok",i={Source:s[r].json.AlgorithmID,Formula:s[r],NeedBytes:0,HasBytes:0},"ok"!==(o=s[r].get_dependencies()).status){p.next=28;break}l=new Map,p.t2=e.keys(o.data);case 16:if((p.t3=p.t2()).done){p.next=28;break}return c=p.t3.value,u=o.data[c],d=!0,"ok"===(h=u.get_doi()).status&&(f=h.data[0],l.get(f)?d=!1:l.set(f,!0)),p.next=24,e.awrap(this.get_manifest_datainfo(u));case 24:"ok"===(m=p.sent).status&&d&&(i.NeedBytes+=m.data.NeedBytes,i.HasBytes+=m.data.HasBytes),p.next=16;break;case 28:a.data.push(i),p.next=8;break;case 31:return p.abrupt("return",a);case 32:case"end":return p.stop()}}),null,this)}}]),a}()}()}).call(this,a(7))},function(t,e,a){(function(t){var e=a(9),s=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Cache=function(){"use strict";function a(t){e(this,a),this.Use_localStorage=!0,this.innerStorage=new Map,t&&t.hasOwnProperty("Use_localStorage")&&(this.Use_localStorage=t.Use_localStorage)}return s(a,[{key:"get_manifest_by_doi",value:function(e){var a={status:"Not found",data:null},s="/manifest/"+e;if(this.Use_localStorage)try{var n=localStorage.getItem(s);if(n)return a.status="ok",a.data=new t.Manifest(JSON.parse(n)),a}catch(i){console.log("get_manifest_by_doi, localStorage.getItem error: "+i)}var r=this.innerStorage.get(s);return r&&(a.status="ok",a.data=r),a}},{key:"set_manifest_by_doi",value:function(t,e){var a="/manifest/"+e;if(this.Use_localStorage)try{return void localStorage.setItem(a,t.ToString())}catch(s){console.log("set_manifest_by_doi, localStorage.setItem error: "+s)}this.innerStorage.set(a,t)}},{key:"delete_manifest_by_doi",value:function(t){var e="/manifest/"+t;if(this.Use_localStorage)try{if(localStorage.getItem(e))return localStorage.removeItem(e),!0}catch(a){console.log("delete_manifest_by_doi, localStorage error: "+a)}return this.innerStorage.delete(e)}},{key:"get_data_by_doi",value:function(t){var e={status:"Not found",data:null},a="/rawdata/"+t,s=null;if(this.Use_localStorage)try{if(s=localStorage.getItem(a)){e.status="ok";var n=Math.ceil(s.length/2);e.data=new Uint8Array(n);for(var r=0;r<n;r++)e.data[r]=parseInt(s.substr(2*r,2),16);return e}}catch(i){console.log("get_data_by_doi, localStorage.getItem error: "+i)}return s||(s=this.innerStorage.get(a))&&(e.status="ok",e.data=s),e}},{key:"get_data_by_manifest",value:function(t){var e={status:"Not found",data:null},a=t.get_doi();if("ok"===a.status)for(var s in a.data){var n=this.get_data_by_doi(a.data[s]);if("ok"===n.status)return e.status="ok",e.data=n.data,e}else e.status="Manifest has no doi";return e}},{key:"set_data_by_doi",value:function(t,e){var a="/rawdata/"+e,s=new Uint8Array(t);if(this.Use_localStorage){for(var n="",r=0;r<s.length;r++)n+=s[r].toString(16).padStart(2,"0");try{return void localStorage.setItem(a,n)}catch(i){console.log("set_data_by_doi, localStorage.setItem error: "+i)}}this.innerStorage.set(a,s)}},{key:"delete_data_by_doi",value:function(t){var e="/rawdata/"+t;if(this.Use_localStorage)try{if(localStorage.getItem(e))return localStorage.removeItem(e),!0}catch(a){console.log("delete_data_by_doi, localStorage error: "+a)}return this.innerStorage.delete(e)}},{key:"clear",value:function(){for(var t=this.get_cached_manifests(),e=0;e<t.length;e++)this.delete_manifest_by_doi(t[e].doi);var a=this.get_cached_data();for(e=0;e<a.length;e++)this.delete_data_by_doi(a[e].doi);return 0!==t.length+a.length}},{key:"get_cached_manifests",value:function(){var t=[];if(this.Use_localStorage)try{for(var e=0;e<localStorage.length;e++){var a=localStorage.key(e);if(!0===a.startsWith("/manifest/")){var s=a.replace("/manifest/",""),n=this.get_manifest_by_doi(s).data;t.push({doi:s,value:n})}}}catch(f){console.log("get_cached_manifests, localStorage error: "+f)}var r=!0,i=!1,o=void 0;try{for(var l,c=this.innerStorage.keys()[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var u=l.value;if(!0===u.startsWith("/manifest/")){var d=u.replace("/manifest/",""),h=this.get_manifest_by_doi(d).data;t.push({doi:d,value:h})}}}catch(m){i=!0,o=m}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return t}},{key:"get_cached_manifests_size",value:function(){var t=0;if(this.Use_localStorage)try{for(var e=0;e<localStorage.length;e++){!0===localStorage.key(e).startsWith("/manifest/")&&t++}}catch(o){console.log("get_cached_manifests_size, localStorage error: "+o)}var a=!0,s=!1,n=void 0;try{for(var r,i=this.innerStorage.keys()[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){!0===r.value.startsWith("/manifest/")&&t++}}catch(l){s=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if(s)throw n}}return t}},{key:"get_cached_data",value:function(){var t=[];if(this.Use_localStorage)try{for(var e=0;e<localStorage.length;e++){var a=localStorage.key(e);if(!0===a.startsWith("/rawdata/")){var s=a.replace("/rawdata/",""),n=this.get_data_by_doi(s).data;t.push({doi:s,value:n})}}}catch(f){console.log("get_cached_data, localStorage error: "+f)}var r=!0,i=!1,o=void 0;try{for(var l,c=this.innerStorage.keys()[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var u=l.value;if(!0===u.startsWith("/rawdata/")){var d=u.replace("/rawdata/",""),h=this.get_data_by_doi(d).data;t.push({doi:d,value:h})}}}catch(m){i=!0,o=m}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return t}},{key:"get_cached_data_size",value:function(){var t=0;if(this.Use_localStorage)try{for(var e=0;e<localStorage.length;e++){!0===localStorage.key(e).startsWith("/rawdata/")&&t++}}catch(o){console.log("get_cached_data_size, localStorage error: "+o)}var a=!0,s=!1,n=void 0;try{for(var r,i=this.innerStorage.keys()[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){!0===r.value.startsWith("/rawdata/")&&t++}}catch(l){s=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if(s)throw n}}return t}}]),a}()}()}).call(this,a(7))},function(t,e,a){(function(t){var e=a(11),s=a(9),n=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Network=function(){"use strict";function a(e,n){if(s(this,a),this.Cache=n,!e.hasOwnProperty("DedicatedServer"))throw new Error("Bad network settings");this.DedicatedServer=new t.Server(e.DedicatedServer)}return n(a,[{key:"search_manifest",value:function(t){var a,s,n,r;return e.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a={status:"Not found",source:null,data:null},0!==(s=t.get_doi()).data.length){i.next=5;break}return a.status="Manifest has no doi",i.abrupt("return",a);case 5:if(!this.DedicatedServer){i.next=22;break}i.t0=e.keys(s.data);case 7:if((i.t1=i.t0()).done){i.next=22;break}return n=i.t1.value,i.next=11,e.awrap(this.search_manifest_by_doi(s.data[n]));case 11:if("ok"!==(r=i.sent).status){i.next=19;break}return a.status="ok",a.source=r.source,a.data=r.data,i.abrupt("return",a);case 19:a.status=r.status;case 20:i.next=7;break;case 22:return i.abrupt("return",a);case 23:case"end":return i.stop()}}),null,this)}},{key:"search_manifest_by_doi",value:function(a){var s,n,r,i;return e.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(s={status:"",source:null,data:null},""!=a){o.next=4;break}return s.status="Empty doi",o.abrupt("return",s);case 4:if(!this.DedicatedServer){o.next=18;break}if("ok"!==(n=this.Cache.get_manifest_by_doi(a)).status){o.next=12;break}s.status="ok",s.source="Cache",s.data=n.data,o.next=16;break;case 12:return o.next=14,e.awrap(this.DedicatedServer.get_manifest_by_doi(a));case 14:if("ok"===(r=o.sent).status)try{i=new t.Manifest(r.data),s.status="ok",s.source="Network",s.data=i,this.Cache.set_manifest_by_doi(i,a)}catch(l){s.status="Not valid manifest ("+l+")"}else s.status=r.status;case 16:o.next=19;break;case 18:s.status="Not implimented";case 19:return o.abrupt("return",s);case 20:case"end":return o.stop()}}),null,this)}},{key:"search_data",value:function(t){var a,s,n,r;return e.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a={status:"Not found",source:null,data:null},0!==(s=t.get_doi()).data.length){i.next=5;break}return a.status="Manifest has no doi",i.abrupt("return",a);case 5:if(!this.DedicatedServer){i.next=22;break}i.t0=e.keys(s.data);case 7:if((i.t1=i.t0()).done){i.next=22;break}return n=i.t1.value,i.next=11,e.awrap(this.search_data_by_doi(s.data[n]));case 11:if("ok"!==(r=i.sent).status){i.next=19;break}return a.status="ok",a.source=r.source,a.data=r.data,i.abrupt("return",a);case 19:a.status=r.status;case 20:i.next=7;break;case 22:return i.abrupt("return",a);case 23:case"end":return i.stop()}}),null,this)}},{key:"search_data_by_doi",value:function(t){var a,s,n;return e.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(a={status:"",source:null,data:null},!this.DedicatedServer){r.next=22;break}if("ok"!==(s=this.Cache.get_data_by_doi(t)).status){r.next=8;break}return a.status="ok",a.source="Cache",a.data=s.data,r.abrupt("return",a);case 8:return r.next=10,e.awrap(this.DedicatedServer.get_data_by_doi(t));case 10:if("ok"!==(n=r.sent).status){r.next=19;break}return a.status="ok",a.source="Network",a.data=n.data,this.Cache.set_data_by_doi(n.data,t),r.abrupt("return",a);case 19:a.status=n.status;case 20:r.next=23;break;case 22:a.status="Not implimented";case 23:return r.abrupt("return",a);case 24:case"end":return r.stop()}}),null,this)}}]),a}()}()}).call(this,a(7))},function(t,e,a){(function(t){var e=a(11),s=a(9),n=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Server=function(){"use strict";function t(e){s(this,t),this.address=e}return n(t,[{key:"get_manifest_by_doi",value:function(t){var a,s,n,r;return e.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a={status:"",data:null},s=this.address+"/manifest/"+t,i.prev=2,i.next=5,e.awrap(fetch(s));case 5:if(n=i.sent,i.prev=6,200!==n.status){i.next=15;break}return i.next=10,e.awrap(n.json());case 10:r=i.sent,a.data=r,a.status="ok",i.next=16;break;case 15:a.status="Response error: "+n.statusText;case 16:i.next=21;break;case 18:i.prev=18,i.t0=i.catch(6),a.status="Error parsing request ("+i.t0+")";case 21:i.next=26;break;case 23:i.prev=23,i.t1=i.catch(2),a.status="Error requesting server ("+i.t1+")";case 26:return i.abrupt("return",a);case 27:case"end":return i.stop()}}),null,this,[[2,23],[6,18]])}},{key:"get_data_by_doi",value:function(t){var a,s,n,r;return e.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a={status:"",data:null},s=this.address+"/rawdata/"+t,i.prev=2,i.next=5,e.awrap(fetch(s));case 5:if(200!==(n=i.sent).status){i.next=14;break}return i.next=9,e.awrap(n.arrayBuffer());case 9:r=i.sent,a.data=r,a.status="ok",i.next=15;break;case 14:a.status="Response error: "+n.statusText;case 15:i.next=20;break;case 17:i.prev=17,i.t0=i.catch(2),a.status="Error requesting server ("+i.t0+")";case 20:return i.abrupt("return",a);case 21:case"end":return i.stop()}}),null,this,[[2,17]])}}]),t}()}()}).call(this,a(7))},function(t,e,a){(function(t){var e=a(11),s=a(9),n=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Formula=function(){"use strict";function a(e,n){if(s(this,a),this.json=e,this.manifest=n,this.wasm=null,this.jsglue=null,this.jsglue_go=null,this.parameters=[],!this.json.hasOwnProperty("actor"))throw new Error("Not found required property actor");if(!this.json.actor.hasOwnProperty("wasm"))throw new Error("Not found required property actor.wasm");if(this.wasm=new t.Manifest(this.json.actor.wasm),this.wasm.ArgName="actor.wasm",this.json.actor.hasOwnProperty("jsglue")&&(this.jsglue=new t.Manifest(this.json.actor.jsglue),this.jsglue.ArgName="actor.jsglue"),this.json.actor.hasOwnProperty("jsglue_go")&&(this.jsglue_go=new t.Manifest(this.json.actor.jsglue_go),this.jsglue_go.ArgName="actor.jsglue_go"),!this.json.hasOwnProperty("parameters"))throw new Error("Not found required property parameters");for(var r in this.json.parameters){var i=new t.Manifest(this.json.parameters[r]);i.ArgName=r,this.parameters.push(i)}}return n(a,[{key:"get_dependencies",value:function(){var t={status:"ok",data:[]};return t.data.push(this.wasm),this.jsglue&&t.data.push(this.jsglue),this.jsglue_go&&t.data.push(this.jsglue_go),this.parameters.forEach((function(e){t.data.push(e)})),t}},{key:"eval",value:function(a){var s,n,r,i,o,l,c,u,d,h;return e.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(s={status:"",data:[]},null!==(n=a.get("actor.wasm"))){f.next=5;break}return s.status="Evaluation failed, has no actor.wasm data",f.abrupt("return",s);case 5:if(r=null,i=null,!this.jsglue){f.next=12;break}if(null!=(r=a.get("actor.jsglue"))){f.next=12;break}return s.status="Evaluation failed, has no actor.jsglue data",f.abrupt("return",s);case 12:if(!this.jsglue_go){f.next=17;break}if(null!=(i=a.get("actor.jsglue_go"))){f.next=17;break}return s.status="Evaluation failed, has no actor.jsglue_go data",f.abrupt("return",s);case 17:o=new Map,f.t0=e.keys(this.parameters);case 19:if((f.t1=f.t0()).done){f.next=29;break}if(l=f.t1.value,c=this.parameters[l].ArgName,null!=(u=a.get(c))){f.next=26;break}return s.status="Evaluation failed, has no "+c+" data",f.abrupt("return",s);case 26:o.set(c,u),f.next=19;break;case 29:return d=null,d=i?new t.WasmGo(n,i):new t.Wasm(n,r),f.next=33,e.awrap(d.init());case 33:if("ok"!==(s=f.sent).status){f.next=39;break}return f.next=37,e.awrap(d.exec(o));case 37:"ok"===(s=f.sent).status&&this.manifest&&"ok"===(h=this.manifest.get_mime()).status&&(s.data.MIME=h.data);case 39:return f.next=41,e.awrap(d.un_init());case 41:return f.abrupt("return",s);case 42:case"end":return f.stop()}}),null,this)}}]),a}()}()}).call(this,a(7))},function(t,e,a){(function(t){var e=a(9),s=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Manifest=function(){"use strict";function a(t){e(this,a),this.json=t}return s(a,[{key:"ToString",value:function(){return JSON.stringify(this.json)}},{key:"get_mime",value:function(){var t={status:"Has no MIME",data:null};return this.json.hasOwnProperty("MIME")&&(t.status="ok",t.data=this.json.MIME),t}},{key:"get_size",value:function(){var t={status:"Has no size",data:null};return this.json.hasOwnProperty("size")&&(t.status="ok",t.data=this.json.size),t}},{key:"get_raw_value",value:function(){var t={status:"Has no raw",data:[]};return this.json.hasOwnProperty("raw")&&(t.status="ok",t.data=new TextEncoder("utf-8").encode(this.json.raw)),t}},{key:"get_doi",value:function(){var t={status:"ok",data:[]};if(this.json.hasOwnProperty("doi"))for(var e in this.json.doi)t.data.push(this.json.doi[e]);else t.status="Has no DOI";return t}},{key:"get_formulas",value:function(){var e=this,a={status:"",data:[]};return this.json.hasOwnProperty("formulas")&&this.json.formulas.forEach((function(s){try{a.data.push(new t.Formula(s,e))}catch(n){a.status+="Error creating formula ("+n+") "}})),""===a.status&&(a.status="ok"),a}}]),a}()}()}).call(this,a(7))},function(t,e,a){(function(t){var e=a(16),s=a(11),n=a(9),r=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.Wasm=function(){"use strict";function t(e,a){n(this,t),this.raw_wasm=e,this.jsglue=a,this.wasm=null,this.wasm_memory=null}return r(t,[{key:"un_init",value:function(){var t;return s.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t={status:"ok"},e.abrupt("return",t);case 2:case"end":return e.stop()}}))}},{key:"init",value:function(){var t,e,a,n,r,i,o=this;return s.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(t={status:"ok"},l.prev=1,null!==this.wasm){l.next=20;break}if(null!==this.jsglue){l.next=14;break}return l.next=6,s.awrap(new WebAssembly.compile(this.raw_wasm));case 6:return e=l.sent,l.next=9,s.awrap(new WebAssembly.instantiate(e,[]));case 9:a=l.sent,this.wasm=a.exports,this.wasm_memory=this.wasm.memory,l.next=20;break;case 14:return n=new TextDecoder,r=n.decode(this.jsglue),i=Function('"use strict";'+r+"return Module;")(),l.next=19,s.awrap(new Promise((function(t,e){o.wasm=new i({wasmBinary:o.raw_wasm,onRuntimeInitialized:function(){t("onRuntimeInitialized")}})})));case 19:this.wasm_memory=this.wasm.wasmMemory;case 20:l.next=25;break;case 22:l.prev=22,l.t0=l.catch(1),t.status=this.create_error("Exception while init: "+l.t0);case 25:return l.abrupt("return",t);case 26:case"end":return l.stop()}}),null,this,[[1,22]])}},{key:"exec",value:function(t){var a,n,r,i,o,l,c,u,d,h,f,m,p,w,b,v,g,_,k,y,E,x,D,S,N,M,j;return s.async((function(I){for(;;)switch(I.prev=I.next){case 0:return a={status:"",data:[]},I.prev=1,I.next=4,s.awrap(this.init());case 4:if("ok"!==(n=I.sent).status){I.next=65;break}r=0,i=!0,o=!1,l=void 0,I.prev=10,c=t[Symbol.iterator]();case 12:if(i=(u=c.next()).done){I.next=48;break}if(d=u.value,h=e(d,2),f=h[0],null!=(m=h[1])){I.next=20;break}return a.status=this.create_error("Wrong usage, one of arguments is empty"),I.abrupt("return",a);case 20:if(p=0,w=new TextEncoder("utf-8").encode(f),b=w.length,0===(v=this.wasm._set_arg_name(r,w.length))){I.next=33;break}for(g=new Uint8ClampedArray(this.wasm_memory.buffer,v,b),_=0;_<g.length;_++)g[_]=w[_];if(0!==(p=this.wasm._get_arg_index(r))){I.next=31;break}return a.status=this.create_last_error(),I.abrupt("return",a);case 31:I.next=35;break;case 33:return a.status=this.create_last_error(),I.abrupt("return",a);case 35:if(k=m.length,0===(y=this.wasm._set_arg(p,k))){I.next=42;break}for(E=new Uint8ClampedArray(this.wasm_memory.buffer,y,k),x=0;x<E.length;x++)E[x]=m[x];I.next=44;break;case 42:return a.status=this.create_last_error(),I.abrupt("return",a);case 44:r++;case 45:i=!0,I.next=12;break;case 48:I.next=54;break;case 50:I.prev=50,I.t0=I.catch(10),o=!0,l=I.t0;case 54:I.prev=54,I.prev=55,i||null==c.return||c.return();case 57:if(I.prev=57,!o){I.next=60;break}throw l;case 60:return I.finish(57);case 61:return I.finish(54);case 62:if(this.wasm._exec())if(D=this.wasm._get_result_size(),0!==(S=this.wasm._get_result())){for(N=[],M=new Uint8ClampedArray(this.wasm_memory.buffer,S,D),j=0;j<M.length;j++)N.push(M[j]);a.status="ok",a.data=N}else a.status=this.create_last_error();else a.status=this.create_last_error();I.next=66;break;case 65:a.status=this.create_error("Init error: "+n.status);case 66:I.next=71;break;case 68:I.prev=68,I.t1=I.catch(1),a.status=this.create_error("Exception while exec: "+I.t1);case 71:return I.abrupt("return",a);case 72:case"end":return I.stop()}}),null,this,[[1,68],[10,50,54,62],[55,,57,61]])}},{key:"create_error",value:function(t){return t}},{key:"create_last_error",value:function(){var t=this.wasm._get_last_error(),e=this.wasm._get_last_error_size(),a=new Uint8ClampedArray(this.wasm_memory.buffer,t,e),s=new TextDecoder;return this.create_error(s.decode(a))}}]),t}()}()}).call(this,a(7))},,,,function(t,e,a){(function(t){var e=a(16),s=a(11),n=a(9),r=a(10);!function(){if("undefined"!==typeof t);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export (neither global, window nor self is defined)");self.global=self}t.WasmGo=function(){"use strict";function t(e,a){if(n(this,t),this.raw_wasm=e,this.jsglue_go=a,this.mod=null,this.inst=null,this.Go=null,!this.raw_wasm)throw new Error("Not specified raw_wasm object!");if(!this.jsglue_go)throw new Error("Not specified jsglue_go object!")}return r(t,[{key:"un_init",value:function(){var t;return s.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t={status:"ok"},e.abrupt("return",t);case 3:case"end":return e.stop()}}))}},{key:"init",value:function(){var t,e,a;return s.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(t={status:"ok"},n.prev=1,this.inst){n.next=13;break}return e=new TextDecoder,a=e.decode(this.jsglue_go),this.Go=Function('"use strict";'+a+"return new Go();")(),n.next=8,s.awrap(new WebAssembly.compile(this.raw_wasm));case 8:return this.mod=n.sent,n.next=11,s.awrap(new WebAssembly.instantiate(this.mod,this.Go.importObject));case 11:this.inst=n.sent,this.Go.run(this.inst).then((function(t){console.log("end run")}));case 13:n.next=18;break;case 15:n.prev=15,n.t0=n.catch(1),t.status="Exception while init: "+n.t0;case 18:return n.abrupt("return",t);case 19:case"end":return n.stop()}}),null,this,[[1,15]])}},{key:"exec",value:function(t){var a,n,r,i,o,l,c,u,d,h,f;return s.async((function(s){for(;;)switch(s.prev=s.next){case 0:a={status:"Not implemented",data:[]},s.prev=1,n=!0,r=!1,i=void 0,s.prev=5,o=t[Symbol.iterator]();case 7:if(n=(l=o.next()).done){s.next=21;break}if(c=l.value,u=e(c,2),d=u[0],null!=(h=u[1])){s.next=15;break}return a.status="Wrong usage, one of arguments is empty",s.abrupt("return",a);case 15:if(_gowasm_setArg(d,h)){s.next=18;break}return a.status=_gowasm_lastError(),s.abrupt("return",a);case 18:n=!0,s.next=7;break;case 21:s.next=27;break;case 23:s.prev=23,s.t0=s.catch(5),r=!0,i=s.t0;case 27:s.prev=27,s.prev=28,n||null==o.return||o.return();case 30:if(s.prev=30,!r){s.next=33;break}throw i;case 33:return s.finish(30);case 34:return s.finish(27);case 35:s.next=40;break;case 37:s.prev=37,s.t1=s.catch(1),a.status="Exception while setArg: "+s.t1;case 40:if(s.prev=40,!(f=_gowasm_execute())){s.next=47;break}a.status="ok",a.data=f,s.next=49;break;case 47:return a.status=_gowasm_lastError(),s.abrupt("return",a);case 49:s.next=54;break;case 51:s.prev=51,s.t2=s.catch(40),a.status="Exception while execute: "+s.t2;case 54:return s.abrupt("return",a);case 55:case"end":return s.stop()}}),null,null,[[1,37],[5,23,27,35],[28,,30,34],[40,51]])}}]),t}()}()}).call(this,a(7))},,,,,function(t,e,a){"use strict";a.r(e);var s=a(0),n=a.n(s),r=a(8),i=a.n(r),o=(a(24),a(2)),l=a(3),c=a(5),u=a(4),d=a(1),h=a(6),f=(a(25),function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={cache:t.cache,updateApp:t.updateApp,application:t.application,showData:t.showData},a.handleCacheOper=a.handleCacheOper.bind(Object(d.a)(a)),a.handleDataView=a.handleDataView.bind(Object(d.a)(a)),a.handleDataDownload=a.handleDataDownload.bind(Object(d.a)(a)),a.handleManifestView=a.handleManifestView.bind(Object(d.a)(a)),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"handleCacheOper",value:function(t){this.state.cache[t.target.name](t.target.value)&&this.state.updateApp()}},{key:"strDigest",value:function(t){var e=t;return"string"!==typeof t&&(e=new Uint8Array(t).toString()),e.length>20?e.substr(0,10)+"..."+e.substr(e.length-10,10):e}},{key:"viewManifestButton",value:function(t){return n.a.createElement("button",{className:"btn btn-sm btn-success ",onClick:this.handleManifestView,value:t},"View Manifest")}},{key:"handleManifestView",value:function(t){var e=this.state.cache.get_manifest_by_doi(t.target.value);this.state.application.updateDataView({MIME:"manifest",data:e.data}),this.props.dataTogglePopup()}},{key:"viewDataButton",value:function(t){var e=this.state.cache.get_manifest_by_doi(t),a=this.state.cache.get_data_by_doi(t);return e.status&&a.status&&null!==e.data?n.a.createElement("button",{className:"btn btn-sm btn-success",onClick:this.handleDataView,value:t},"View Data"):""}},{key:"handleDataView",value:function(t){var e=this.state.cache.get_manifest_by_doi(t.target.value),a=this.state.cache.get_data_by_doi(t.target.value);this.state.application.updateDataView({MIME:e.data.get_mime().data,data:a.data}),this.props.dataTogglePopup()}},{key:"DataDownloadButton",value:function(t){var e=this.state.cache.get_manifest_by_doi(t);return"ok"===this.state.cache.get_data_by_doi(t).status&&"ok"===e.status?n.a.createElement("button",{className:"btn btn-sm btn-success m-1",onClick:this.handleDataDownload,value:t},"Download"):""}},{key:"handleDataDownload",value:function(t){var e=this.state.cache.get_manifest_by_doi(t.target.value),a=e.data.get_mime();if("ok"===a.status){var s=e.data.get_doi();if("ok"===s.status){var n="";"application/vnd.openxmlformats-officedocument.presentationml.presentation"===a.data&&(n=".pptx"),"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===a.data&&(n=".docx"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===a.data&&(n=".xlsx");var r=this.state.cache.get_data_by_doi(t.target.value),i=new Blob([r.data],{type:a.data}),o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download=s.data[0]+n,o.click()}}}},{key:"render",value:function(){var t=this,e=this.state.cache,a=e.get_cached_manifests(),s=e.get_cached_data(),r="col-md-6 alert alert-success alert-dismissible fade show",i=a.map((function(e,a){return n.a.createElement("div",{key:a,className:"row"},n.a.createElement("div",{className:r,title:e.doi}," ",t.strDigest(e.doi)),n.a.createElement("div",{className:r},t.strDigest(JSON.stringify(e.value))),n.a.createElement("div",{className:"col-md-6"},t.viewManifestButton(e.doi)),n.a.createElement("div",{className:"col-md-6"},n.a.createElement("button",{className:"btn btn-sm btn-danger m-1",onClick:t.handleCacheOper,name:"delete_manifest_by_doi",value:e.doi},"Delete")),n.a.createElement("div",{className:"col-md-12 p-2"}))})),o=s.map((function(e){return n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:r,title:e.doi},t.strDigest(e.doi)),n.a.createElement("div",{className:r},t.strDigest(e.value)," Data length = ",e.value.length),n.a.createElement("div",{className:"col-md-6"},t.viewDataButton(e.doi),t.DataDownloadButton(e.doi)),n.a.createElement("div",{className:"col-md-6"},n.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:t.handleCacheOper,name:"delete_data_by_doi",value:e.doi},"Delete")))}));return n.a.createElement("div",{className:"Cache col-lg-12 bg-secondary m-2 text-white"},n.a.createElement("div",{className:"col-md-12 font-weight-bold"}," CACHE "),n.a.createElement("div",{className:"row m-2"},n.a.createElement("div",{className:"col-md-6 text-md-left font-weight-bold p-1"},"Entity type"),n.a.createElement("div",{className:"col-md-6 text-md-right font-weight-bold p-1"},"Count"),n.a.createElement("div",{className:"col-md-12 border-bottom"})),n.a.createElement("div",{className:"row m-2"},n.a.createElement("div",{className:"col-md-11 text-md-left p-1"},"Manifest"),n.a.createElement("div",{className:"col-md-1 alert alert-success alert-dismissible fade show p-1"},e.get_cached_manifests_size())),n.a.createElement("div",{className:"row m-2"},n.a.createElement("div",{className:"col-md-11 text-md-left p-1"},"Data"),n.a.createElement("div",{className:"col-md-1  alert alert-success alert-dismissible fade show p-1"},e.get_cached_data_size())),n.a.createElement("div",{className:"col-md-12 border-bottom"}),n.a.createElement("div",{className:"col-md-12"},n.a.createElement("button",{className:"btn btn-sm btn-warning m-3",onClick:this.handleCacheOper,name:"clear",value:"()"},"Clear")),n.a.createElement("div",{className:"col-md-6 text-md-left font-weight-bold p-2"},"DOI"),n.a.createElement("div",{className:"col-md-6 text-md-left font-weight-bold p-2"},"Manifest"),i,n.a.createElement("div",{className:"col-md-12 p-3 border-bottom"}),n.a.createElement("div",{className:"col-md-6  text-md-left font-weight-bold p-2"},"DOI"),n.a.createElement("div",{className:"col-md-6  text-md-left font-weight-bold p-2"},"Data"),o)}}]),e}(s.Component)),m=a(11),p=a.n(m),w=a(14),b=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={network:t.network,updateApp:t.updateApp,fetchManifestResult:"",fetchDataResult:"",doi:"",defaultValue:"Pick DOI from the list"},a.handleFetch=a.handleFetch.bind(Object(d.a)(a)),a.handleDOIChange=a.handleDOIChange.bind(Object(d.a)(a)),a.handleClearDOI=a.handleClearDOI.bind(Object(d.a)(a)),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"handleDOIChange",value:function(t){this.setState({doi:t.target.value})}},{key:"handleClearDOI",value:function(){var t=this;this.setState({doi:""},(function(){return console.log(t.state.doi)}))}},{key:"handleFetch",value:function(t){var e,a=this;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e=t.target.value,""!==this.state.doi){s.next=4;break}return this.setState(Object(w.a)({},e,"Empty DOI")),s.abrupt("return");case 4:this.state.network[t.target.name](this.state.doi).then((function(t){a.setState(Object(w.a)({},e,t.status)),"ok"===t.status&&a.state.updateApp()}));case 5:case"end":return s.stop()}}),null,this)}},{key:"render",value:function(){return n.a.createElement("div",{className:"Network p-1 bg-secondary rounded-lg text-white"},n.a.createElement("div",{className:"col-md-12 font-weight-bold p-1"},"NETWORK"),n.a.createElement("div",{className:"col-md-12"},n.a.createElement("select",{className:"form-control alert-success alert-dismissible fade show p-2",id:"dois",onChange:this.handleDOIChange,value:this.state.doi},n.a.createElement("option",{defaultValue:!0},"Choose DOI from the list"),n.a.createElement("option",{value:"03FEE1468FF693744FDEFB20D41E793E6A03CFBDD3687901EA99271DCC702DF8"},"Doi 1 ",this.state.doi),n.a.createElement("option",{value:"00A66067BD93F5417D9E94858795B6E852EF90DE790C543B1E47A2E009D435F3"},"Doi 2 ",this.state.doi),n.a.createElement("option",{value:"0487DEB729ABE42001007D1ADBEF310FE6BCBD308B7A889458F2E1F8B1C5D14E"},"Doi 3 ",this.state.doi))),n.a.createElement("div",{style:{display:this.state.doi?"block":"none"}},n.a.createElement("div",{className:"col-md-12"},n.a.createElement("button",{className:"btn btn-sm active btn-secondary m-3",onClick:this.handleFetch,name:"search_manifest_by_doi",value:"fetchManifestResult"},"Fetch Manifest"),n.a.createElement("div",{className:"col-md-12 alert alert-success"},this.state.fetchManifestResult)),n.a.createElement("div",{className:"col-md-12"},n.a.createElement("button",{className:"btn btn-sm active btn-secondary m-3",onClick:this.handleFetch,name:"search_data_by_doi",value:"fetchDataResult"},"Fetch Data"),n.a.createElement("div",{className:"col-md-12 alert alert-success",style:{display:this.state.doi?"block":"none"}},this.state.fetchDataResult)),n.a.createElement("div",{className:"col-md-12"},n.a.createElement("button",{className:"btn btn-sm btn-warning",onClick:this.handleClearDOI,name:"clear_DOI"},"Clear")," ")))}}]),e}(s.Component),v=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={application:t.application,updateApp:t.updateApp,formula:t.formula,cache:t.application.engine.cache(),network:t.application.engine.network(),evalResult:"",dataTogglePopup:t.dataTogglePopup},a.handleEval=a.handleEval.bind(Object(d.a)(a)),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"handleEval",value:function(t){var e=this,a=t.target,s=t.target.innerHTML;t.target.innerHTML="evaluating...",this.state.application.engine.eval(this.state.formula).then((function(t){e.setState({evalResult:t.status}),e.state.updateApp(),a.innerHTML=s}))}},{key:"getDependencies",value:function(){var t=this,e=this.props.formula.get_dependencies();return 0===e.data.length?"ok"!==e.status?"Error getting dependency: "+e.status:"Has no dependency":e.data.map((function(e,a){return n.a.createElement("div",{key:a},e.ArgName,n.a.createElement(g,{application:t.state.application,dataTogglePopup:t.state.dataTogglePopup,updateApp:t.state.updateApp,manifest:{data:e,status:"ok"}}))}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"col-md-12"},n.a.createElement("button",{className:"btn btn-sm btn-warning m-2",onClick:this.handleEval},"Evaluate Formula"),n.a.createElement("div",{className:"border-bottom m-2"}),this.state.evalResult,this.getDependencies())}}]),e}(s.Component),g=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={application:t.application,updateApp:t.updateApp,cache:t.application.engine.cache(),network:t.application.engine.network(),manifest:t.manifest,init_manifest:t.manifest,rootManifest:t.rootManifest,showData:t.showData,dataTogglePopup:t.dataTogglePopup,showFormulas:t.showFormulas},a.handleFetchManifest=a.handleFetchManifest.bind(Object(d.a)(a)),a.handleRemoveManifest=a.handleRemoveManifest.bind(Object(d.a)(a)),a.handleFetchData=a.handleFetchData.bind(Object(d.a)(a)),a.handleRemoveData=a.handleRemoveData.bind(Object(d.a)(a)),a.handleViewData=a.handleViewData.bind(Object(d.a)(a)),a.handleManifestView=a.handleManifestView.bind(Object(d.a)(a)),a.state.rootManifest&&(a.updateManifest=a.updateManifest.bind(Object(d.a)(a)),a.state.application.setUpdateManifest(a.updateManifest)),a.handleChangeManifestFocus=a.handleChangeManifestFocus.bind(Object(d.a)(a)),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"handleViewData",value:function(){this.state.application.updateDataView({MIME:this.state.manifest.data.get_mime().data,data:this.state.manifest.rawData}),this.state.updateApp(),this.state.dataTogglePopup()}},{key:"handleManifestView",value:function(){var t=this.state.manifest;this.state.updateApp(),this.state.application.updateDataView({MIME:"manifest",data:t.data}),this.state.dataTogglePopup()}},{key:"handleChangeManifestFocus",value:function(){this.state.rootManifest?this.state.application.PopManifestFocusList():this.state.application.PushManifestFocusList(this.state.manifest)}},{key:"updateManifest",value:function(){this.setState({manifest:this.state.application.getCurrentManifest(),init_manifest:this.state.application.getCurrentManifest()}),this.state.updateApp()}},{key:"handleFetchManifest",value:function(t){var e=this,a=t.target,s=t.target.innerHTML;t.target.innerHTML="fetching...",this.state.network.search_manifest_by_doi(t.target.value).then((function(t){"ok"===t.status?(e.setState({manifest:t}),e.state.updateApp()):a.innerHTML=s}))}},{key:"handleRemoveManifest",value:function(t){this.state.cache.delete_manifest_by_doi(t.target.value)&&(this.setState({manifest:this.state.init_manifest}),this.state.updateApp())}},{key:"handleFetchData",value:function(t){var e=this,a=t.target,s=t.target.innerHTML;t.target.innerHTML="fetching...",this.state.network.search_data_by_doi(t.target.value).then((function(t){if("ok"===t.status){var n=e.state.manifest;n.rawData=t.data,e.setState({manifest:n})}else a.innerHTML=s;e.state.updateApp()}))}},{key:"handleRemoveData",value:function(t){if(this.state.cache.delete_data_by_doi(t.target.value)){var e=this.state.manifest;e.rawData=null,this.setState({manifest:e}),this.state.updateApp()}}},{key:"getManifestHeader",value:function(){var t=n.a.createElement("div",null,'"Has no DOI"'),e=this.state.manifest.data.get_doi();if("ok"===e.status){var a=e.data[0],s=this.state.cache.get_manifest_by_doi(a);"ok"===s.status?this.state.manifest=s:this.state.manifest=this.state.init_manifest;var r=this.state.cache.get_data_by_doi(a);if("ok"===r.status)this.state.manifest.rawData=r.data;else{var i=this.state.manifest.data.get_raw_value();"ok"===i.status?this.state.manifest.rawData=i.data:this.state.manifest.rawData=null}var o="ok"===this.state.manifest.data.get_mime().status?"MIME: '"+this.state.manifest.data.get_mime().data+"'":this.state.manifest.data.get_mime().status,l="ok"===this.state.manifest.data.get_size().status?"Size: "+this.state.manifest.data.get_size().data:this.state.manifest.data.get_size().status;if(t=a?a.length>10?"DOI: "+a.substr(0,10)+"..."+a.substr(a.length-10,10)+o+", "+l:"DOI: "+a+"; "+o+", "+l:"Has no DOI "+o+", "+l,null!=this.state.manifest.rawData){var c=new Uint8Array(this.state.manifest.rawData).toString();t=t+", Data: "+c.substr(0,10)+"..."+c.substr(c.length-10,10)}else t+=", Has no data";t+=")"}var u=n.a.createElement("div",{className:"text-left m-2 text-truncate"},n.a.createElement("p",{className:"m-1"},"MIME:"," ",null!==this.state.manifest.data.get_mime().data?this.state.manifest.data.get_mime().data:"Has no MIME"),n.a.createElement("p",{className:"m-1"},"Size:"," ",null!==this.state.manifest.data.get_size().data?(this.state.manifest.data.get_size().data/1024).toFixed(2)+" kB":"Has no size"),n.a.createElement("p",{className:"m-1"},"DOI:"," ",null!==this.state.manifest.data.get_doi().data?this.state.manifest.data.get_doi().data:"Has no DOI"),n.a.createElement("p",{className:"m-1"}," ","Raw Value:"," ",null!==this.state.manifest.rawData?this.state.manifest.data.get_raw_value().data:"There is no raw value"));return t&&u}},{key:"getManifestControls",value:function(){var t,e,a="",s=this.state.manifest.data.get_doi();if(t=n.a.createElement("button",{className:"btn btn-sm btn-success m-1",onClick:this.handleManifestView},"View Manifest"),e=n.a.createElement("button",{className:"btn btn-sm btn-success m-1",onClick:this.handleViewData},"View Data"),"ok"===s.status){var r=s.data[0],i=this.state.cache.get_manifest_by_doi(r),o="";o="ok"===i.status?n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-sm btn-danger m-1",onClick:this.handleRemoveManifest,value:r},"Remove Manifest")):n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-sm btn-primary m-1",onClick:this.handleFetchManifest,value:r},"Fetch Manifest"));var l=n.a.createElement("div",null,t),c=this.state.cache.get_data_by_doi(r),u="";u="ok"===c.status?n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-sm btn-danger m-1",onClick:this.handleRemoveData,value:r},"Remove Data")):n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-sm btn-primary m-1",onClick:this.handleFetchData,value:r},"Fetch Data"));var d="";"ok"!==i.status&&"ok"!==this.state.manifest.data.get_mime().status||"ok"!==c.status?"ok"===this.state.manifest.data.get_mime().status&&this.state.manifest.rawData&&(d=n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-sm btn-info m-1",onClick:this.handleViewData},"View Data"))):d=n.a.createElement("div",null,e),a=n.a.createElement("div",{className:"btn-group bg-secondary border-0",role:"group","aria-label":"Manifest controls"},n.a.createElement("div",null,o),n.a.createElement("div",null,u),n.a.createElement("div",null,d),n.a.createElement("div",null,l))}return a}},{key:"getManifestFormulas",value:function(){var t=this,e=this.state.manifest.data.get_formulas();return 0===e.data.length?"ok"!==e.status?"Error getting formulas: "+e.status:"Has no formulas":e.data.map((function(e,a){return n.a.createElement("div",{key:a,className:"bg-secondary text-white"},n.a.createElement(v,{application:t.state.application,dataTogglePopup:t.state.dataTogglePopup,updateApp:t.state.updateApp,formula:e}))}))}},{key:"render",value:function(){if(null==this.state.manifest||"ok"!==this.state.manifest.status){var t=null!=this.state.manifest?this.state.manifest.status:"is not defined";return n.a.createElement("nav",{className:"Manifest bg-secondary text-white m-2"},n.a.createElement("div",{className:"alert alert-success alert-dismissible fade show rounded-lg"},n.a.createElement("div",{className:"col-md-12 font-weight-bold text-center"},"MANIFEST"),n.a.createElement("div",{className:"text-center"},t)))}var e=n.a.createElement("button",{className:"btn btn-md btn-secondary",onClick:this.handleChangeManifestFocus},n.a.createElement("span",{role:"img","aria-label":"lookup"},"\ud83d\udd0d"));this.state.rootManifest&&(e=!1===this.state.application.ManifestFocusListIsEmpty()?n.a.createElement("button",{className:"btn btn-md btn-secondary",onClick:this.handleChangeManifestFocus},n.a.createElement("span",{role:"img","aria-label":"return"},"\u23ce")):"");return this.props.showFormulas?n.a.createElement("div",null,e,n.a.createElement("div",null,this.getManifestFormulas())):null,n.a.createElement("nav",{className:"Manifest"},n.a.createElement("div",{className:"p-1 border-0 bg-secondary rounded-lg text-white"},n.a.createElement("div",{className:"d-flex justify-content-end m-0"},e),n.a.createElement("div",{className:"alert alert-success alert-dismissible fade show rounded-lg"}," ",this.getManifestHeader()),n.a.createElement("div",null,this.getManifestControls()),n.a.createElement("div",null,this.getManifestFormulas())))}}]),e}(s.Component),_=a(12),k=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={cacheIsShown:t.cacheIsShown,networkIsShown:t.networkIsShown,viewerIsShown:t.viewerIsShown,application:t.application},a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return n.a.createElement("div",{className:"NavTabs bg-secondary text-white rounded-lg p-4"},n.a.createElement("ul",{className:"nav nav-tabs bg-secondary md-tabs",id:"myTabMD",role:"tablist"},n.a.createElement("li",{className:"nav-item "},n.a.createElement("a",{className:"nav-link active btn btn-sm m-2 "+(this.props.cacheIsShown||this.props.networkIsShown||this.props.viewerIsShown?"btn-secondary":"btn-warning"),id:"home-tab-md","data-toggle":"tab",href:"#home-md",role:"tab","aria-controls":"network-md","aria-selected":"true",onClick:this.props.handleHomePage},"Home")),n.a.createElement("li",{className:"nav-item"},n.a.createElement("a",{className:"nav-link active btn btn-sm m-2 "+(this.props.cacheIsShown?"btn-warning":"btn-secondary"),id:"cache-tab-md","data-toggle":"tab",href:"#cache-md",role:"tab","aria-controls":"cache-md","aria-selected":"false",onClick:this.props.handleShowCache},"Cache")),n.a.createElement("li",{className:"nav-item"},n.a.createElement("a",{className:"nav-link active btn btn-sm m-2 "+(this.props.networkIsShown?"btn-warning":"btn-secondary"),id:"network-tab-md","data-toggle":"tab",href:"#network-md",role:"tab","aria-controls":"network-md","aria-selected":"false",onClick:this.props.handleShowNetwork},"Network")),n.a.createElement("li",{className:"nav-item"},n.a.createElement("a",{className:"nav-link active btn btn-sm m-2 "+(this.props.viewerIsShown?"btn-warning":"btn-secondary"),id:"viewer-tab-md","data-toggle":"tab",href:"#viewer-md",role:"tab","aria-controls":"viewer-md","aria-selected":"false",onClick:this.props.handleShowViewer},"Viewer")),n.a.createElement("li",{className:"nav-item"},n.a.createElement("a",{className:"nav-link active btn btn-sm m-2 "+("ok"===this.props.application.current_manifest_status?"btn-warning":"btn-secondary"),id:"viewer-tab-md","data-toggle":"tab",href:"#viewer-md",role:"tab","aria-controls":"viewer-md","aria-selected":"false",onClick:this.props.handleClearAll},"Clear All"))))}}]),e}(n.a.Component),y=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).dataTogglePopup=function(){a.setState({showData:!a.state.showData})},a.handleShowCache=function(){a.setState({cacheIsShown:!a.state.cacheIsShown})},a.handleShowNetwork=function(){a.setState({networkIsShown:!a.state.networkIsShown})},a.handleShowViewer=function(){a.setState({viewerIsShown:!a.state.viewerIsShown})},a.handleHomePage=function(){a.setState({cacheIsShown:!1,networkIsShown:!1,viewerIsShown:!1})},a.handleClearAll=function(){a.state.application.setNewManifest(null),a.state.cache.clear(),a.updateApp()},a.state={application:t.application,cache:t.application.getCache(),network:t.application.getNetwork(),cacheIsShown:!1,networkIsShown:!1,viewerIsShown:!1,showData:!1},a.updateApp=a.updateApp.bind(Object(d.a)(a)),a.dataTogglePopup=a.dataTogglePopup.bind(Object(d.a)(a)),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"updateApp",value:function(){this.forceUpdate()}},{key:"render",value:function(){return n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"App col-lg-12 bg-secondary rounded mb-0 text-white"},n.a.createElement(k,{handleShowCache:this.handleShowCache,handleShowNetwork:this.handleShowNetwork,handleShowViewer:this.handleShowViewer,handleHomePage:this.handleHomePage,handleClearAll:this.handleClearAll,cacheIsShown:this.state.cacheIsShown,networkIsShown:this.state.networkIsShown,viewerIsShown:this.state.viewerIsShown,application:this.state.application}),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(g,{application:this.state.application,updateApp:this.updateApp,showData:this.state.showData,dataTogglePopup:this.dataTogglePopup.bind(this),manifest:this.state.application.getCurrentManifest(),rootManifest:!0})),n.a.createElement("br",null),n.a.createElement("div",null,this.state.cacheIsShown?n.a.createElement(f,{application:this.state.application,showData:this.state.showData,dataTogglePopup:this.dataTogglePopup.bind(this),cache:this.state.cache,updateApp:this.updateApp}):null),n.a.createElement("br",null),n.a.createElement("div",null,this.state.networkIsShown?n.a.createElement(b,{network:this.state.network,updateApp:this.updateApp}):null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(_.a,{application:this.state.application,cache:this.state.cache,handleShowViewer:this.handleShowViewer.bind(this),dataTogglePopup:this.dataTogglePopup.bind(this),showData:this.state.showData,viewerIsShown:this.state.viewerIsShown}))))}}]),e}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=a(13),x=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={application:t.application,textAreaID:t.textAreaID},a.actionClick=a.actionClick.bind(Object(d.a)(a)),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"actionClick",value:function(t){var e=document.getElementById(this.state.textAreaID).value;this.state.application.setNewManifest(e)}},{key:"render",value:function(){return n.a.createElement("button",{className:"btn btn-sm btn-primary m-2 float-center",onClick:this.actionClick},"Manifest to App")}}]),e}(s.Component),D=a(18),S=new E.a("https://kolmoblocks.org/StaticData",!0);i.a.render(n.a.createElement(y,{application:S}),document.getElementById("root")),document.querySelectorAll("div.interactive-canvas").forEach((function(t){if(t.querySelector("textarea.manifest-text")){var e=t.querySelector("textarea.manifest-text").id,a=t.querySelector("span.run-button-placeholder");if(a&&i.a.render(n.a.createElement(x,{application:S,textAreaID:e}),a),t.querySelector("span.manifest-data-placeholder")){var s=t.querySelector("span.manifest-data-placeholder").id;(a=t.querySelector("span.render-button-placeholder"))&&i.a.render(n.a.createElement(D.a,{textAreaID:e,manifestDataHolderID:s}),a)}}})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}],[[19,1,2]]]);
//# sourceMappingURL=main.6e96ac18.chunk.js.map